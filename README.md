# 🧩 RectPack - أداة تجميع السجاد المتقدمة

أداة متقدمة لتقسيم المستطيلات (السجاد) إلى مجموعات محسنة وفق شروط العرض والطول باستخدام خوارزميات ذكية.  
تتميز بواجهة رسومية حديثة وخيارات تصدير متعددة ونظام إعدادات متقدم.

---

## ✨ المميزات الجديدة والمحسنة

### 🎨 واجهة رسومية محسنة
- تصميم حديث مع أيقونات وألوان متناسقة
- تخطيط منظم مع تبويبات للسجل والنتائج
- شريط تقدم لمتابعة العمليات
- رسائل حالة واضحة ومفيدة

### 🔧 خوارزمية محسنة
- نظام تسجيل نقاط ذكي لاختيار أفضل المرشحين
- تحسين استراتيجية البحث عن الشركاء
- معالجة أفضل للحالات الاستثنائية
- تقارير تقدم مفصلة أثناء المعالجة

### 📊 خيارات تصدير متقدمة
- **Excel** - التقرير الأساسي (3 أوراق)
- **PDF** - تقرير مرئي مبسط
- **CSV** - بيانات مفصلة للتحليل
- **JSON** - بيانات منظمة للتطبيقات الأخرى
- **تقرير نصي مفصل** - ملخص شامل بالعربية

### ⚙️ إعدادات متقدمة
- نافذة إعدادات شاملة مع تبويبات متعددة
- معاملات الخوارزمية القابلة للتخصيص
- إعدادات الأداء والذاكرة
- خيارات التصدير والتسمية
- إعدادات التحقق والسجلات

### 🛡️ تحسينات الأمان والموثوقية
- نظام تحقق محسن من صحة البيانات
- معالجة أخطاء شاملة مع رسائل واضحة
- نظام سجلات متقدم مع دعم العربية
- فحص أحجام الملفات والصلاحيات

---

## 🚀 التشغيل

### 1. إنشاء بيئة افتراضية

```bash
python -m venv .venv
# على لينكس/ماك
source .venv/bin/activate
# على ويندوز
.venv\Scripts\activate
```

### 2. تثبيت الاعتمادات

```bash
pip install -r requirements.txt

### 3. تشغيل الواجهة

python main.py
```

---

## 📥 المدخلات

- ملف Excel بالصيغة التالية (أول 3 أعمدة):

  -width length qty
  -126 170 182
  -133 190 12
  -145 200 130

  ***

## 📤 المخرجات

1. ملف Excel (3 أوراق):

تفاصيل المجموعات: كل مجموعة مع القطع المستخدمة.

ملخص المجموعات: العرض الإجمالي، الطول المرجعي، المساحة.

السجاد المتبقي: ما لم يُستخدم من القطع.

2. تقرير PDF:

قائمة بالمجموعات مع تفاصيل مبسطة.

## 🛠️ الإعدادات

### الإعدادات الأساسية
يمكن تعديل الإعدادات الأساسية من خلال:
1. **الواجهة الرسومية** - استخدم أزرار التحكم في الواجهة
2. **نافذة الإعدادات المتقدمة** - اضغط على زر "⚙️ إعدادات"
3. **ملف الإعدادات** - `config/config.json`

### الإعدادات المتاحة

#### معاملات التجميع الأساسية
```json
{
  "min_width": 370,          // العرض الأدنى للمجموعة (سم)
  "max_width": 400,          // العرض الأقصى للمجموعة (سم)
  "tolerance_length": 100,   // هامش التسامح في الطول (سم)
  "start_with_largest": true,    // البدء بالأكبر عرضاً
  "allow_split_rows": true       // السماح بتقسيم الصفوف
}
```

#### إعدادات الأداء
```json
{
  "max_iterations": 10000,      // الحد الأقصى للتكرارات
  "progress_interval": 100,     // فترة تقرير التقدم
  "regroup_rounds": 100,        // عدد جولات إعادة التجميع
  "enable_caching": true,       // تفعيل التخزين المؤقت
  "cleanup_temp": true          // تنظيف الملفات المؤقتة
}
```

#### خيارات التصدير
```json
{
  "export_pdf": true,           // تصدير PDF
  "export_csv": false,          // تصدير CSV
  "export_json": false,         // تصدير JSON
  "export_detailed": false,     // تقرير مفصل
  "file_prefix": "rectpack_results",  // بادئة اسم الملف
  "include_timestamp": true     // إضافة الطابع الزمني
}
```

📂 هيكل المشروع
CutOptimizer/
│── main.py
│── README.md
│── requirements.txt
│
├── config/
│ └── config.json
│
├── core/
│ ├── models.py
│ ├── grouping.py
│ └── validation.py
│
├── data_io/
│ ├── excel_io.py
│ └── pdf_report.py
│
└── ui/
└── app.py

🧪 مثال عملي
ملف الإدخال:
width length qty
240 340 100
160 230 200
130 200 50
ناتج Excel:

ورقة 1 (تفاصيل المجموعات):

المجموعة_1 | 240x340 | مستخدم: 100 | طول إجمالي: 34,000
المجموعة_1 | 160x230 | مستخدم: 148 | طول إجمالي: 34,040

ورقة 2 (ملخص المجموعات):

المجموعة_1 | العرض الإجمالي = 400 | الطول المرجعي ≈ 34,000

ورقة 3 (المتبقي):

160x230 | الكمية المتبقية: 52
130x200 | الكمية المتبقية: 50

تقرير PDF:

يحتوي على ملخص نصي للمجموعة مع المعرفات، الأبعاد، الكميات المستخدمة والمتبقية.

📜 ملاحظات

البرنامج يتطلب Python 3.8 أو أعلى (بسبب الاعتماد على fpdf2).

يمكن تعديل الخوارزمية أو إضافة استراتيجيات أخرى بسهولة عبر core/grouping.py.

---

## 🆕 التحديثات الأخيرة

### الإصدار 2.0 - تحسينات شاملة

#### ✨ ما الجديد:
- **واجهة رسومية محسنة بالكامل** مع تصميم حديث وأيقونات
- **نظام إعدادات متقدم** مع نافذة إعدادات شاملة
- **خيارات تصدير متعددة** (CSV, JSON, تقرير مفصل)
- **نظام سجلات متقدم** مع دعم كامل للعربية
- **خوارزمية محسنة** مع نظام تسجيل نقاط ذكي

#### 🔧 التحسينات:
- تحسين كبير في أداء الخوارزمية
- معالجة أخطاء أفضل مع رسائل واضحة
- تحقق محسن من صحة البيانات
- شريط تقدم ورسائل حالة مفيدة
- دعم أفضل للملفات الكبيرة

#### 🐛 إصلاحات:
- إصلاح خطأ في دالة `validate_carpets` (كانت تتحقق من العنصر الأول فقط)
- تحسين معالجة الحالات الاستثنائية
- إصلاح مشاكل الترميز مع النصوص العربية
- تحسين استقرار التطبيق بشكل عام

---

## 📋 متطلبات النظام

- **Python 3.8+** (مطلوب لـ fpdf2)
- **نظام التشغيل**: Windows, macOS, Linux
- **الذاكرة**: 512 MB RAM كحد أدنى
- **مساحة القرص**: 100 MB للتطبيق + مساحة للملفات

---

## 🤝 المساهمة والدعم

### الإبلاغ عن المشاكل
إذا واجهت أي مشكلة، يرجى:
1. التحقق من ملف السجل في مجلد `logs/`
2. إرفاق ملف السجل مع وصف المشكلة
3. تحديد إصدار Python ونظام التشغيل

### اقتراح التحسينات
نرحب بالاقتراحات لتحسين الأداة، خاصة:
- خوارزميات تجميع جديدة
- تحسينات على الواجهة الرسومية
- صيغ تصدير إضافية
- ميزات جديدة للتحليل

---

## 📄 الترخيص

هذا المشروع مفتوح المصدر ومتاح للاستخدام والتطوير.

---

## 🙏 شكر وتقدير

شكر خاص لجميع المساهمين في تطوير وتحسين هذه الأداة.
تم تطوير هذا الإصدار المحسن بهدف توفير تجربة أفضل وأكثر موثوقية للمستخدمين.
