# 🧩 Carpet Grouping Tool (RectPack)

أداة لتقسيم المستطيلات (السجاد) إلى مجموعات وفق شروط العرض والطول باستخدام خوارزمية جشعة (Greedy).  
تُستخدم للتأكد من أن كل مجموعة تحقق قيود العرض والطول مع تقارير Excel و PDF منظمة.

---

## ⚙️ المميزات

- قراءة بيانات السجاد من ملف **Excel**.
- تجميع المستطيلات في مجموعات وفق:
  - **إجمالي العرض** ضمن نطاق محدد (`min_width` – `max_width`).
  - **تقارب الطول الإجمالي** ضمن هامش مسموح (`tolerance_length`).
- إخراج:
  - ملف **Excel** بثلاث أوراق (تفاصيل، ملخص، المتبقي).
  - تقرير **PDF** مبسط للمجموعات.
- إعدادات مرنة عبر ملف `config/config.json`.
- واجهة رسومية مبنية على **PySide6**.

---

## 🚀 التشغيل

### 1. إنشاء بيئة افتراضية

```bash
python -m venv .venv
# على لينكس/ماك
source .venv/bin/activate
# على ويندوز
.venv\Scripts\activate
```

### 2. تثبيت الاعتمادات

```bash
pip install -r requirements.txt

### 3. تشغيل الواجهة

python main.py
```

---

## 📥 المدخلات

- ملف Excel بالصيغة التالية (أول 3 أعمدة):

  -width length qty
  -126 170 182
  -133 190 12
  -145 200 130

  ***

## 📤 المخرجات

1. ملف Excel (3 أوراق):

تفاصيل المجموعات: كل مجموعة مع القطع المستخدمة.

ملخص المجموعات: العرض الإجمالي، الطول المرجعي، المساحة.

السجاد المتبقي: ما لم يُستخدم من القطع.

2. تقرير PDF:

قائمة بالمجموعات مع تفاصيل مبسطة.

🛠️ الإعدادات

الموجودة في: config/config.json

{
"min_width": 370,
"max_width": 400,
"tolerance_length": 100,
"min_total_area": null,
"max_total_area": null,
"start_with_largest": true,
"allow_split_rows": true
}

📂 هيكل المشروع
CutOptimizer/
│── main.py
│── README.md
│── requirements.txt
│
├── config/
│ └── config.json
│
├── core/
│ ├── models.py
│ ├── grouping.py
│ └── validation.py
│
├── data_io/
│ ├── excel_io.py
│ └── pdf_report.py
│
└── ui/
└── app.py

🧪 مثال عملي
ملف الإدخال:
width length qty
240 340 100
160 230 200
130 200 50
ناتج Excel:

ورقة 1 (تفاصيل المجموعات):

المجموعة_1 | 240x340 | مستخدم: 100 | طول إجمالي: 34,000
المجموعة_1 | 160x230 | مستخدم: 148 | طول إجمالي: 34,040

ورقة 2 (ملخص المجموعات):

المجموعة_1 | العرض الإجمالي = 400 | الطول المرجعي ≈ 34,000

ورقة 3 (المتبقي):

160x230 | الكمية المتبقية: 52
130x200 | الكمية المتبقية: 50

تقرير PDF:

يحتوي على ملخص نصي للمجموعة مع المعرفات، الأبعاد، الكميات المستخدمة والمتبقية.

📜 ملاحظات

البرنامج يتطلب Python 3.8 أو أعلى (بسبب الاعتماد على fpdf2).

يمكن تعديل الخوارزمية أو إضافة استراتيجيات أخرى بسهولة عبر core/grouping.py.

```

```
